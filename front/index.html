<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#3b82f6" />
    <meta name="description" content="Sistema de inventario con control de ventas" />
    <title>Plus Control - Dashboard v2.1</title>
    <link rel="manifest" href="/manifest.json" />
    <link rel="icon" type="image/png" href="/icon-192.png" />
    <link rel="apple-touch-icon" href="/icon-192.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css?v=2.1" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script defer src="app.js?v=2.1"></script>
  </head>
  <body>
    <div id="toastContainer" class="toast-container"></div>
    
    <header class="topbar">
      <div class="brand">
        <div class="brand-mark">PC</div>
        <div>
          <p class="eyebrow">Plus Control v2.1</p>
          <h1>Dashboard</h1>
        </div>
      </div>
      <div class="topbar-actions">
        <span id="userDisplay" class="user-display"></span>
        <button
          id="reportToggleBtn"
          class="btn btn-ghost"
          type="button"
          aria-expanded="false"
        >
          Weekly Report
        </button>
        <button id="backupBtn" class="btn btn-ghost">Backup BD</button>
        <button id="logoutBtn" class="btn btn-ghost">Logout</button>
      </div>
    </header>

    <main class="container">
      <section class="stats">
        <article class="stat-card">
          <p class="stat-label">Total Items</p>
          <p id="statItems" class="stat-value">0</p>
          <p id="statItemsTrend" class="stat-trend"></p>
        </article>
        <article class="stat-card">
          <p class="stat-label">Total Units</p>
          <p id="statUnits" class="stat-value">0</p>
          <p id="statUnitsTrend" class="stat-trend"></p>
        </article>
        <article class="stat-card">
          <p class="stat-label">Low Stock</p>
          <p id="statLow" class="stat-value">0</p>
          <p id="statLowTrend" class="stat-trend"></p>
        </article>
        <article class="stat-card">
          <p class="stat-label">Inventory Value</p>
          <p id="statValue" class="stat-value">$0.00</p>
          <p id="statValueTrend" class="stat-trend"></p>
        </article>
        <article class="stat-card">
          <p class="stat-label">Cash (Profit)</p>
          <p id="statCash" class="stat-value">$0.00</p>
          <p id="statCashTrend" class="stat-trend"></p>
        </article>
      </section>

      <section class="panel alert-panel" id="lowStockPanel" hidden>
        <div class="panel-header">
          <div>
            <h2>‚ö†Ô∏è Low Stock Alert</h2>
            <p>Items below threshold</p>
          </div>
        </div>
        <div id="lowStockList" class="alert-items"></div>
      </section>

      <section class="panel chart-panel">
        <div class="panel-header">
          <h2>Sales Analytics</h2>
        </div>
        <div class="chart-grid">
          <div class="chart-container">
            <h3>Weekly Sales</h3>
            <canvas id="salesChart"></canvas>
          </div>
          <div class="chart-container">
            <h3>Top 5 Products</h3>
            <canvas id="topProductsChart"></canvas>
          </div>
        </div>
      </section>

      <div id="weeklyDash" class="report-dash is-collapsed">
        <section class="panel report-panel">
          <div class="panel-header">
            <div>
              <h2>Weekly Report</h2>
              <p id="weeklyRange">Week of --</p>
            </div>
            <div class="filter-actions">
              <button
                id="reportPrintBtn"
                class="btn btn-ghost"
                type="button"
              >
                Imprimir
              </button>
              <button
                id="reportBackBtn"
                class="btn btn-ghost"
                type="button"
              >
                Volver
              </button>
            </div>
          </div>
          <div class="report-grid">
            <div class="report-card">
              <p class="report-label">Total Sales</p>
              <p id="weeklyTotal" class="report-value">$0.00</p>
            </div>
            <div class="report-card">
              <p class="report-label">Orders</p>
              <p id="weeklyCount" class="report-value">0</p>
            </div>
            <div class="report-card">
              <p class="report-label">Units</p>
              <p id="weeklyUnits" class="report-value">0</p>
            </div>
          </div>
          <div class="report-breakdown">
            <p class="report-label">By payment method</p>
            <div id="weeklyByPayment" class="report-list"></div>
          </div>
        </section>
      </div>

      <section class="panel form-panel">
        <div class="panel-header">
          <div>
            <h2>Add Item</h2>
            <p>Register a new product in inventory.</p>
          </div>
        </div>
        <form id="itemForm" class="form-grid" autocomplete="off">
          <input type="hidden" id="itemId" />
          <label>
            Name
            <input id="name" name="name" type="text" required />
          </label>
          <label>
            SKU
            <input id="sku" name="sku" type="text" required />
          </label>
          <label>
            Quantity
            <input id="quantity" name="quantity" type="number" min="0" required />
          </label>
          <label>
            Location
            <input id="location" name="location" type="text" required />
          </label>
          <label>
            Unit Cost ($)
            <input id="costUnit" name="costUnit" type="number" min="0" step="0.01" required />
            <span class="form-hint">What it cost you per unit</span>
          </label>
          <label>
            Unit Price ($)
            <input id="price" name="price" type="number" min="0" step="0.01" required />
            <span class="form-hint">Sale price per unit</span>
          </label>
          <label>
            Low Stock Threshold
            <input
              id="threshold"
              name="threshold"
              type="number"
              min="0"
              value="5"
              required
            />
          </label>
          <div class="form-actions">
            <button type="submit" class="btn btn-primary" id="saveBtn">
              Save Item
            </button>
            <button type="button" class="btn btn-ghost" id="cancelEdit" hidden>
              Cancel Edit
            </button>
          </div>
        </form>
      </section>

      <section class="panel table-panel">
        <div class="panel-header">
          <div>
            <h2>Inventory</h2>
            <p>View and manage all items.</p>
          </div>
          <div class="filter-actions">
            <input
              id="search"
              class="input"
              type="search"
              placeholder="Search by name or SKU"
            />
            <label class="toggle">
              <input id="lowOnly" type="checkbox" />
              <span>Low stock</span>
            </label>
            <select id="sortBy" class="input">
              <option value="updated">Newest</option>
              <option value="name">Name (A-Z)</option>
              <option value="quantity">Qty (High-Low)</option>
              <option value="value">Value (High-Low)</option>
            </select>
          </div>
        </div>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>SKU</th>
                <th>Qty</th>
                <th>Location</th>
                <th>Price</th>
                <th>Updated</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="inventoryBody"></tbody>
          </table>
        </div>
      </section>

      <section class="panel table-panel">
        <div class="panel-header">
          <div>
            <h2>Sales</h2>
            <p>Register and review sales.</p>
          </div>
          <div class="filter-actions">
            <button
              id="salesToggleBtn"
              class="btn btn-primary"
              type="button"
              aria-expanded="false"
            >
              Agregar venta
            </button>
          </div>
        </div>

          <div id="paymentSummary" class="payment-summary" style="display: none;">
            <h3>Sales Summary by Payment Method</h3>
            <div class="summary-cards">
              <div class="summary-card">
                <p class="summary-label">‚ö° Yappy Total</p>
                <p id="yappyTotal" class="summary-value">$0.00</p>
              </div>
              <div class="summary-card">
                <p class="summary-label">üíµ Efectivo Total</p>
                <p id="efectivoTotal" class="summary-value">$0.00</p>
              </div>
              <div class="summary-card">
                <p class="summary-label">Total Sales</p>
                <p id="totalSales" class="summary-value">$0.00</p>
              </div>
            </div>
          </div>
            </div>
          </div>
          <form id="saleForm" class="form-grid" autocomplete="off">
            <label>
              Product
              <select id="saleItemId" required>
                <option value="">-- Select a product --</option>
              </select>
            </label>
            <label>
              Unit Price
              <input id="salePriceInput" type="number" min="0" step="0.01" required />
            </label>
            <label>
              Quantity to Sell
              <input id="saleQuantity" type="number" min="1" value="1" required />
            </label>
            <label>
              Payment Method
              <select id="salePaymentMethod" required>
                <option value="">-- Select payment method --</option>
                <option value="Efectivo">Efectivo</option>
                <option value="Yappy">Yappy</option>
              </select>
            </label>
            <label>
              Total
              <input id="saleTotalInput" type="number" min="0" step="0.01" required />
            </label>
            <div class="form-actions">
              <button type="submit" class="btn btn-primary">Register Sale</button>
            </div>
            <p id="saleError" class="form-hint" aria-live="polite"></p>
          </form>
        </section>

        <section class="panel table-panel">
          <div class="panel-header">
            <div>
              <h2>Sales History</h2>
              <p>View all recorded sales.</p>
            </div>
            <div class="filter-actions">
              <input
                id="salesSearch"
                class="input"
                type="search"
                placeholder="Search product"
              />
              <select id="salesPaymentFilter" class="input">
                <option value="">All payments</option>
                <option value="Efectivo">Efectivo</option>
                <option value="Yappy">Yappy</option>
              </select>
            </div>
          </div>
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>Product</th>
                  <th>Qty</th>
                  <th>Unit Price</th>
                  <th>Total</th>
                  <th>Gain</th>
                  <th>Payment</th>
                  <th>Date</th>
                  <th></th>
                </tr>
              </thead>
              <tbody id="salesBody"></tbody>
            </table>
          </div>

          <div class="sales-summary">
            <div class="summary-card">
              <p class="summary-label">üíµ Efectivo</p>
              <p id="totalEfectivo" class="summary-value">$0.00</p>
            </div>
            <div class="summary-card">
              <p class="summary-label">‚ö° Yappy</p>
              <p id="totalYappy" class="summary-value">$0.00</p>
            </div>
            <div class="summary-card">
              <p class="summary-label">Total Vendido</p>
              <p id="totalVentas" class="summary-value">$0.00</p>
            </div>
          </div>
        </section>
      </div>


    </main>
  </body>
</html>
